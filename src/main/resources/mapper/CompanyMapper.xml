<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.wimir.bae.domain.company.mapper.CompanyMapper">

    <!-- 업체명 중복 확인 -->
    <select id="isCompanyNameExist" resultType="boolean">
        SELECT IF(COUNT(*)>0, true, false)
        FROM tbl_company
        WHERE is_deleted = 0
          AND company_name = #{companyName}
    </select>

    <!-- 업체 등록 -->
    <insert id="createCompany">
        INSERT INTO tbl_company(
            company_type_flag, company_name, company_reg_number, ceo_name, address, note
        )
        VALUES (
            #{companyTypeFlag}, #{companyName}, #{companyRegNumber}, #{ceoName}, #{address}, #{note}
        )
    </insert>

    <!-- 업체 목록 조회 -->
    <select id="getCompanyList" resultType="com.wimir.bae.domain.company.dto.CompanyInfoDTO">
    SELECT
        company_key,
        company_type_flag,
        company_name,
        company_reg_number,
        ceo_name,
        address,
        note
    FROM tbl_company
    WHERE is_deleted = 0
    </select>

    <!-- 업체 정보 -->
    <select id="getCompanyInfo" resultType="com.wimir.bae.domain.company.dto.CompanyInfoDTO">
        SELECT
            *
        FROM tbl_company
        WHERE is_deleted = 0
          AND company_key = #{companyKey}
    </select>

    <!-- 업체 수정 -->
    <update id="updateCompany">
        UPDATE tbl_company
        SET
            company_name = #{companyName},
            company_reg_number = #{companyRegNumber},
            ceo_name = #{ceoName},
            address = #{address},
            note = #{note}
        WHERE
            is_deleted = 0
          AND company_key = #{companyKey}
    </update>


</mapper>